**Дата:** 8 ноября 2025 г.

**Статус:** Принято

**Контекст:** 

При разработке Медицинской Системы Записи мы стоим перед выбором архитектурной формы системы. Нам необходимо учесть масштабируемость, надежность, скорость разработки и возможность быстро вносить изменения.

**Рассмотренные варианты:**

1. **Модульный монолит:** Одно приложение, разделенное на модули, каждый из которых отвечает за определенную функциональность.
2. **Микросервисы:** Разделение системы на независимые сервисы, которые взаимодействуют между собой посредством API.
3. **Серверлесс:** Архитектура, при которой разработчикам не требуется управлять серверами, а код выполняется в ответ на события.

**Решение:**

Выбраны микросервисы.

**Обоснование:**
- Чёткая декомпозиция ответственности между сервисами улучшает поддерживаемость и позволяет независимо развивать и масштабировать компоненты, критичные для медицины (например, хранение и обработка медицинских записей отдельно от подсистемы аутентификации).
- Масштабируемость: систему можно масштабировать горизонтально и затрагивать только необходимые части.
- Независимые деплойменты ускоряют релизы для отдельных команд и уменьшают риски при внесении изменений.
- Явные API и контрактное тестирование повышают предсказуемость интеграций между командами.
- Поддержка разных стеков технологий для разных задач (обработка событий, realtime, аналитика) при сохранении границ.
- Наличие API для каждого сервиса даёт возможность реализовать тонкую градацию доступа (RBAC, ACL), централизованную аутентификацию/авторизацию (OAuth2/OIDC) и изоляцию данных при правильной реализации.
- API Gateway, Service Mesh и/или WAF могут:
  - централизовать аутентификацию и авторизацию,
  - реализовать rate limiting, throttling и WAF‑политики,
  - обеспечивать TLS/mTLS и шифрование внутри кластера,
  - производить маршрутизацию, канареечные релизы и нормализацию нагрузки.
- Повышение доступности и отказоустойчивости: при отказе отдельного сервиса остальные компоненты продолжают работать.
- Легкость тестирования отдельных компонентов: автономные сервисы проще покрываются unit/integration тестами.

**Недостатки решения:**
- Разнородность стеков и сред усложняет конфигурацию, наблюдаемость и операционную работу; требует стандартов платформы и единых практик (контейнеризация, логирование, метрики).
- Сложность эксплуатации: CI/CD, оркестрация (Kubernetes), мониторинг, трассировка и управление конфигурацией и секретами.
- Распределённые транзакции и согласованность данных требуют паттернов (sagas, idempotency, event-driven approaches).
- Увеличенная задержка из‑за сетевых вызовов; необходимость резервирования, ретраев и circuit breakers.
- Повышенные требования к observability и безопасности (mTLS, RBAC, секреты, аудит, centralized logging/tracing).
- Микросервисы увеличивают поверхность атаки и сетевую сложность — без соответствующих мер централизованного контроля и hardening безопасность может снизиться.

**Последствия:**
- Требуется строгая стандартизация API, практик деплоя и работы с секретами.
- Необходимо инвестировать в DevOps/DevSecOps: API Gateway, Service Mesh, identity provider, секрет‑менеджер и централизованный мониторинг/аудит.
- Управление согласованностью данных и коммуникацией между сервисами становится предметом архитектурных решений и операционных процессов.
